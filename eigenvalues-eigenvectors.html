<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Lineare Regression</title>
  <meta name="description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen.">
  <meta name="generator" content="bookdown 0.4 and GitBook 2.6.7">

  <meta property="og:title" content="Lineare Regression" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen." />
  <meta name="github-repo" content="systats/linear_model" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lineare Regression" />
  
  <meta name="twitter:description" content="Dieses Book hat zum Ziel moderne Ansätze der Statistik einfach aber detailiert zu erklären. Neben den theoretischen Konzepten werden verschiedene Darstellungsformate und Modelimplication besprochen." />
  

<meta name="author" content="Simon Roth">


<meta name="date" content="2017-11-13">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="dimesnionality-reduction.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="part"><span><b>I Start</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Einstieg</a></li>
<li class="chapter" data-level="2" data-path="grundlagen.html"><a href="grundlagen.html"><i class="fa fa-check"></i><b>2</b> Grundlagen</a></li>
<li class="part"><span><b>II Lieneare Regression</b></span></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> Basics</a></li>
<li class="chapter" data-level="4" data-path="lm-modellauswahl.html"><a href="lm-modellauswahl.html"><i class="fa fa-check"></i><b>4</b> LM Modellauswahl</a></li>
<li class="chapter" data-level="5" data-path="reporting.html"><a href="reporting.html"><i class="fa fa-check"></i><b>5</b> Reporting</a></li>
<li class="chapter" data-level="6" data-path="modelldiagnose.html"><a href="modelldiagnose.html"><i class="fa fa-check"></i><b>6</b> Modelldiagnose</a></li>
<li class="chapter" data-level="7" data-path="non-linearitat.html"><a href="non-linearitat.html"><i class="fa fa-check"></i><b>7</b> Non-Linearität</a></li>
<li class="chapter" data-level="8" data-path="dimesnionality-reduction.html"><a href="dimesnionality-reduction.html"><i class="fa fa-check"></i><b>8</b> Dimesnionality Reduction</a></li>
<li class="chapter" data-level="9" data-path="eigenvalues-eigenvectors.html"><a href="eigenvalues-eigenvectors.html"><i class="fa fa-check"></i><b>9</b> Eigenvalues/ Eigenvectors</a><ul>
<li class="chapter" data-level="9.1" data-path="eigenvalues-eigenvectors.html"><a href="eigenvalues-eigenvectors.html#k-means-clustering"><i class="fa fa-check"></i><b>9.1</b> k-Means Clustering</a></li>
<li class="chapter" data-level="9.2" data-path="eigenvalues-eigenvectors.html"><a href="eigenvalues-eigenvectors.html#pca"><i class="fa fa-check"></i><b>9.2</b> PCA</a></li>
<li class="chapter" data-level="9.3" data-path="eigenvalues-eigenvectors.html"><a href="eigenvalues-eigenvectors.html#exploratory-factor-analysis"><i class="fa fa-check"></i><b>9.3</b> Exploratory Factor Analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lineare Regression</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eigenvalues-eigenvectors" class="section level1">
<h1><span class="header-section-number">9</span> Eigenvalues/ Eigenvectors</h1>
<p>Eigen = “latent” or characteristic</p>
<ul>
<li><span class="math inline">\(x\)</span> eigenvector</li>
<li><span class="math inline">\(\lambda\)</span> einevalue</li>
</ul>
<p><span class="math display">\[Ax = \lambda x\]</span></p>
<ul>
<li>PCA: unsupervised</li>
<li>t-SNE: Supervised</li>
</ul>
<div id="k-means-clustering" class="section level2">
<h2><span class="header-section-number">9.1</span> k-Means Clustering</h2>
<p>Kmeans is one of the most popular and simple algorithm to discover underlying structures in your data. The goal of kmeans is simple, split your data in k different groups represented by their mean. The mean of each group is assumed to be a good summary of each observation of this cluster.</p>
<p>Different type of clustering algorithms exist such a k-means, k-medoids, hierarchical clustering …</p>
<p>Basically, this equation means that we are looking for the k centers which will minimize the distance between them and the points of their cluster. This is an optimization problem, but since the function, we want to minimize is not convex and some variables are binary, it cannot be solved in classic ways with gradient descent. The usual way to solve it is the following:</p>
<ol style="list-style-type: decimal">
<li>Initialize randomly the centers by selecting k-observations</li>
<li>While some convergence criterion is not met
<ul>
<li>Assign each observation to its closest center</li>
<li>Update each center. The new centers are the mean of the observation of each group.</li>
<li>Update the convergence criterion.</li>
</ul></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="kw">library</span>(tidyr)

imm_dat &lt;-<span class="st"> </span>ess_work <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">drop_na</span>(<span class="kw">contains</span>(<span class="st">&quot;imm&quot;</span>)) <span class="co"># only drops sepecial NA</span>

imm_k &lt;-<span class="st"> </span>imm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;imm&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="co">#scale() %&gt;%</span>
<span class="st">  </span><span class="kw">kmeans</span>(., <span class="dv">2</span>)

<span class="kw">library</span>(ggfortify)

<span class="kw">autoplot</span>(imm_k, <span class="dt">data =</span> imm_dat, <span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="dt">colour =</span> <span class="st">&#39;pc&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>country)</code></pre></div>
<p><img src="linear_model_files/figure-html/kmeans-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(imm_k, <span class="dt">data =</span> imm_dat, <span class="dt">frame =</span> T)</code></pre></div>
<p><img src="linear_model_files/figure-html/kmeans-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(imm_k, <span class="dt">data =</span> imm_dat, <span class="dt">frame =</span> T, <span class="dt">frame.type =</span> <span class="st">&#39;norm&#39;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/kmeans-3.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2017</span>)

dat &lt;-<span class="st"> </span>imm_dat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(country, <span class="kw">contains</span>(<span class="st">&quot;imm&quot;</span>)) 

performance &lt;-<span class="st"> </span><span class="kw">c</span>()
<span class="cf">for</span> (jj <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>) {
 clust &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dat[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">centers =</span> jj)
 performance &lt;-<span class="st"> </span><span class="kw">c</span>(performance, <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>clust<span class="op">$</span>tot.withinss <span class="op">/</span><span class="st"> </span>clust<span class="op">$</span>totss)
}

<span class="kw">data.frame</span>(
  <span class="dt">metrics =</span> performance,
  <span class="dt">ncenter =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>
) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ncenter, <span class="dt">y =</span> metrics)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">3</span>, <span class="dt">color=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/purrr-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
res &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="op">~</span><span class="st"> </span><span class="kw">kmeans</span>(dat[,<span class="op">-</span><span class="dv">1</span>], .))
<span class="kw">autoplot</span>(res, <span class="dt">data =</span> imm_dat, <span class="dt">ncol =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/purrr-2.png" width="576" /></p>
</div>
<div id="pca" class="section level2">
<h2><span class="header-section-number">9.2</span> PCA</h2>
<ul>
<li><a href="http://rpubs.com/sinhrks/plot_pca" class="uri">http://rpubs.com/sinhrks/plot_pca</a></li>
<li><a href="http://enhancedatascience.com/2017/07/31/machine-learning-explained-dimensionality-reduction/" class="uri">http://enhancedatascience.com/2017/07/31/machine-learning-explained-dimensionality-reduction/</a></li>
<li><a href="http://rstudio-pubs-static.s3.amazonaws.com/27823_dbc155ba66444eae9eb0a6bacb36824f.html">pca fitting process</a></li>
<li><a href="http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/112-pca-principal-component-analysis-essentials/">Very extensive round about</a></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;factoextra&quot;</span>)

imm_dat1 &lt;-<span class="st"> </span>ess_work <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(country <span class="op">==</span><span class="st"> &quot;DE&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;imm&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>na.omit 

imm_pca1 &lt;-<span class="st"> </span>imm_dat1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">scale</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">prcomp</span>(<span class="dv">2</span>)

<span class="co">#eig.val &lt;- get_eigenvalue(imm_pca)</span>
<span class="co">#var &lt;- get_pca_var(imm_pca)</span>

<span class="kw">fviz_eig</span>(imm_pca1, <span class="dt">addlabels =</span> <span class="ot">TRUE</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">80</span>))</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fviz_pca_var</span>(imm_pca1, <span class="dt">col.var =</span> <span class="st">&quot;black&quot;</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-2.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Total cos2 of variables on Dim.1 and Dim.2</span>
<span class="kw">fviz_cos2</span>(imm_pca1, <span class="dt">choice =</span> <span class="st">&quot;var&quot;</span>, <span class="dt">axes =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-3.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Color by cos2 values: quality on the factor map</span>
<span class="kw">fviz_pca_var</span>(imm_pca1, <span class="dt">col.var =</span> <span class="st">&quot;cos2&quot;</span>,
             <span class="dt">gradient.cols =</span> <span class="kw">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>, <span class="st">&quot;#FC4E07&quot;</span>), 
             <span class="dt">repel =</span> <span class="ot">TRUE</span> <span class="co"># Avoid text overlapping</span>
             )</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-4.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Contributions of variables to PC1</span>
<span class="kw">fviz_contrib</span>(imm_pca1, <span class="dt">choice =</span> <span class="st">&quot;var&quot;</span>, <span class="dt">axes =</span> <span class="dv">1</span>, <span class="dt">top =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-5.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Contributions of variables to PC2</span>
<span class="kw">fviz_contrib</span>(imm_pca1, <span class="dt">choice =</span> <span class="st">&quot;var&quot;</span>, <span class="dt">axes =</span> <span class="dv">2</span>, <span class="dt">top =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-6.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The total contribution to PC1 and PC2 is obtained with</span>
<span class="kw">fviz_contrib</span>(imm_pca1, <span class="dt">choice =</span> <span class="st">&quot;var&quot;</span>, <span class="dt">axes =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dt">top =</span> <span class="dv">10</span>)</code></pre></div>
<p><img src="linear_model_files/figure-html/unnamed-chunk-3-7.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggfortify)

<span class="kw">autoplot</span>(imm_pca1, <span class="dt">data =</span> imm_dat1, <span class="dt">loadings =</span> <span class="ot">TRUE</span>, <span class="dt">alpha =</span> .<span class="dv">1</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">  </span>viridis<span class="op">::</span><span class="kw">scale_colour_viridis</span>(<span class="dt">discrete =</span> T)</code></pre></div>
<p><img src="linear_model_files/figure-html/pca-1.png" width="576" /></p>
</div>
<div id="exploratory-factor-analysis" class="section level2">
<h2><span class="header-section-number">9.3</span> Exploratory Factor Analysis</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">imm_efa &lt;-<span class="st"> </span>imm_dat1 <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">factanal</span>(.,<span class="dt">factors =</span> <span class="dv">2</span>, <span class="dt">scores =</span> <span class="st">&#39;regression&#39;</span>)

<span class="kw">autoplot</span>(imm_efa, <span class="dt">data =</span> imm_dat1, <span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="dt">loadings =</span> T) <span class="op">+</span><span class="st"> </span>viridis<span class="op">::</span><span class="kw">scale_colour_viridis</span>(<span class="dt">discrete =</span> T)</code></pre></div>
<p><img src="linear_model_files/figure-html/efa-1.png" width="576" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dimesnionality-reduction.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
